[tools]
java = "21"
node = "latest"
"npm:npm-groovy-lint" = "latest"
pnpm = "latest"
python = "latest"
uv = "latest"

[env]
# This tells mise to automatically activate the .venv in this directory
_.python.venv = ".venv"

workdata = "./workdata"
common_dir = "./packages/common"
frontend_dir = "./packages/frontend"

star_t_dir = "{{env.workdata}}/star_t_server"
raw_assets_dir = "{{env.workdata}}/raw_assets"
assets_dir = "{{env.frontend_dir}}/static/assets"

[tasks."forgemod:build"]
description = "Build mod"
run = "./gradlew build"
dir = "{{config_root}}/forgemod"
sources = ["*.gradle", "src/**/*.java", "src/**/*.kt", "src/main/resources"]
outputs = ["build/libs/komarubrowser-*.jar"]

[tasks."star_t:copy"]
description = "Run Star Technologu with mod"
depends = ["forgemod-build"]
dir = "{{config_root}}"
run = "./scripts/run_star_t.sh"
# sources = ["build/libs/komarubrowser-*.jar"]
# outputs = ["workdata/star_t_server/mods/komarubrowser-*.jar"]

[tasks."star_t:run"]
description = "Run Star Technologu with mod"
depends = ["star_t:copy"]
dir = "{{env.star_t_dir}}"
run = "./run.sh --nogui --port 26767"
raw = true


[tasks.assets]
description = "Prepare assets"
run = "# dummy task to combine all assets tasks"
depends = ["assets:*"]

[tasks.common]

